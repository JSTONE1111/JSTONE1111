# ğŸš€ Complete Auto-Release Pipeline Setup

## ğŸ“‹ Overview

This system provides **fully automated**:
- âœ… PR auto-labeling from branch names
- âœ… PR title auto-formatting to Conventional Commits
- âœ… Automatic version bumping (semver)
- âœ… Changelog generation with emoji sections
- âœ… GitHub Releases with detailed notes
- âœ… PR notification when changes are released

---

## ğŸ¯ Setup Instructions

### 1. Create GitHub Workflows

Copy these files to your repo:

```
.github/
â”œâ”€â”€ workflows/
â”‚   â”œâ”€â”€ auto-label.yml          # Auto-label and format PRs
â”‚   â”œâ”€â”€ release-changelog.yml   # Auto-release on main merge
â”‚   â””â”€â”€ commitlint.yml          # Validate commit messages (from earlier)
```

### 2. Create Configuration Files

**`.versionrc.json`** (in repo root):
```json
{
  "types": [
    { "type": "feat", "section": "âœ¨ Features" },
    { "type": "fix", "section": "ğŸ› Bug Fixes" },
    { "type": "perf", "section": "âš¡ Performance" },
    { "type": "refactor", "section": "â™»ï¸ Refactoring" },
    { "type": "docs", "section": "ğŸ“š Documentation" },
    { "type": "test", "section": "ğŸ§ª Tests" },
    { "type": "build", "section": "ğŸ“¦ Build System" },
    { "type": "ci", "section": "ğŸ”§ CI/CD" },
    { "type": "chore", "section": "ğŸ”¨ Chores" }
  ]
}
```

**`package.json`** (add if not exists):
```json
{
  "name": "your-project",
  "version": "1.0.0",
  "private": true
}
```

### 3. Configure GitHub Settings

#### Required Permissions:
Go to **Settings â†’ Actions â†’ General â†’ Workflow permissions**:
- âœ… Enable "Read and write permissions"
- âœ… Enable "Allow GitHub Actions to create and approve pull requests"

#### Branch Protection (Recommended):
Go to **Settings â†’ Branches â†’ Add rule** for `main`:
- âœ… Require status checks (commitlint)
- âœ… Require PR before merging
- âœ… Enable squash merging (use PR title)

---

## ğŸŒ³ Branch Naming Convention

Developers should create branches following this pattern:

| Branch Pattern | Auto Label | Commit Type | Example |
|---------------|------------|-------------|---------|
| `feat/*` | `feature` | `feat:` | `feat/user-auth` |
| `fix/*` | `bug` | `fix:` | `fix/login-crash` |
| `docs/*` | `documentation` | `docs:` | `docs/api-guide` |
| `refactor/*` | `refactor` | `refactor:` | `refactor/auth-logic` |
| `test/*` | `testing` | `test:` | `test/unit-coverage` |
| `perf/*` | `performance` | `perf:` | `perf/query-speed` |
| `chore/*` | `chore` | `chore:` | `chore/update-deps` |
| `ci/*` | `ci-cd` | `ci:` | `ci/add-tests` |
| `style/*` | `style` | `style:` | `style/formatting` |
| `build/*` | `build` | `build:` | `build/webpack-config` |

---

## ğŸ”„ Complete Workflow Example

### Step 1: Developer Creates Branch
```bash
git checkout -b feat/add-login-page
# Make changes
git add .
git commit -m "wip: working on login"  # Can be anything!
git push origin feat/add-login-page
```

### Step 2: Open PR
- **GitHub Action automatically**:
  - âœ… Adds `feature` label
  - âœ… Formats title to `feat: add login page`
  - âœ… Comments explaining the change

### Step 3: Review & Merge
- **Reviewer approves**
- **Merge using "Squash and merge"**
- **Squashed commit** = `feat: add login page` âœ… (from PR title)

### Step 4: Automated Release ğŸ‰
When merged to `main`, GitHub Actions automatically:

1. **Analyzes commits** since last release
2. **Determines version bump**:
   - `feat:` â†’ Minor bump (1.0.0 â†’ 1.1.0)
   - `fix:` â†’ Patch bump (1.1.0 â†’ 1.1.1)
   - `BREAKING CHANGE:` â†’ Major bump (1.1.1 â†’ 2.0.0)
3. **Generates CHANGELOG.md**:
   ```markdown
   ## [1.1.0] - 2025-10-01
   
   ### âœ¨ Features
   - add login page (#42)
   
   ### ğŸ› Bug Fixes
   - resolve crash on empty input (#41)
   ```
4. **Creates Git tag** `v1.1.0`
5. **Publishes GitHub Release** with notes
6. **Comments on merged PRs** to notify contributors

---

## ğŸ“Š What Gets Generated

### CHANGELOG.md
```markdown
# Changelog

## [1.2.0] (2025-10-01)

### âœ¨ Features
* add user authentication (#42) ([a1b2c3d](link))
* implement dark mode (#45) ([d4e5f6g](link))

### ğŸ› Bug Fixes
* resolve login redirect issue (#43) ([g7h8i9j](link))
* fix memory leak in dashboard (#44) ([j0k1l2m](link))

### ğŸ“š Documentation
* update API documentation (#46) ([m3n4o5p](link))
```

### GitHub Release Page
- **Title**: v1.2.0
- **Body**: Formatted changelog
- **Assets**: Auto-generated by GitHub
- **Linked**: All PRs and commits clickable

---

## ğŸ¯ Version Bumping Logic

| Commit Type | Version Change | Example |
|-------------|---------------|---------|
| `fix:` | Patch | 1.0.0 â†’ 1.0.1 |
| `feat:` | Minor | 1.0.1 â†’ 1.1.0 |
| `feat!:` or `BREAKING CHANGE:` | Major | 1.1.0 â†’ 2.0.0 |
| `chore:`, `docs:`, etc. | No bump | - |

**Special Cases**:
- First release: Creates `1.0.0`
- Only chores/docs: Creates patch bump
- Multiple types: Uses highest priority (major > minor > patch)

---

## ğŸ”§ Troubleshooting

### Labels Not Appearing?
Check: Settings â†’ Actions â†’ General â†’ Enable "Read and write permissions"

### Release Not Triggering?
- Ensure `package.json` exists with `version` field
- Check workflow runs in Actions tab
- Verify branch protection isn't blocking pushes

### Changelog Empty?
- Ensure commits since last tag follow Conventional Commits
- Check `.versionrc.json` is in repo root
- Run `npx standard-version --dry-run` locally to debug

### Version Not Bumping?
- Verify at least one `feat:` or `fix:` commit exists
- Check if `package.json` version is synced with latest tag
- Look for errors in Actions logs

---

## ğŸš€ Advanced Customization

### Custom Emojis
Edit `.versionrc.json` `types` sections to change emojis.

### Skip CI for Releases
Add to release workflow:
```yaml
- name: Push changes
  run: |
    git push --follow-tags origin main
  env:
    SKIP_CI: true
```

### Pre-release Versions
For `develop` branch:
```yaml
npx standard-version --prerelease alpha
# Creates: 1.1.0-alpha.0
```

### Monorepo Support
Use `lerna-changelog` or `conventional-changelog-lerna` instead.

---

## ğŸ“ Summary

**Zero-touch release pipeline**:
1. Branch name = PR label
2. PR label = Commit type
3. Commit type = Version bump
4. Version bump = Changelog + Release
5. Release = Notification to contributors

**Your job**: Write code. Everything else is automated. ğŸ‰